$def with (username, s)

$if s is None:
    <h1>游戏尚未开始</h1>
    <a href="/admin">Admin</a>
$else:
    $ player = s.context.get_player(username)
    
    <iframe src="../message/$username" width="100%" height="50%" id="iframe1" marginheight="0" frameborder="0" onLoad="autoResize('iframe1');">
      
    </iframe>
    
    <p>
    <table width="100%" border="1">
    <tr>
    $for p in s.context.players:
        <td align="center" width="${100.0/len(s.context.players)}%" class="$('live' if p.live else 'dead')">
        $if player == p:
            <div class="me">
        $p.nickname
        $if player == p:
            </div>
        
        </td>
    </tr>
    <table>
    </p>
    
    $if isinstance(s, models.GameOver):
        <h1>游戏结束</h1>
    $elif player in s.actors:
        <form action="" method="post">
        <input type="hidden" name="sid" value="$id(s)">
        $if s.targets is not None:
            <table>
            $for target in s.targets:
                <tr><td><input type="radio" name="target" value="$target.username">$target.nickname</input></td></tr>
            <tr><td><input type="radio" name="target" value="None">取消/弃权</input></td></tr>
            </table>
        $if isinstance(s, models.TalkStatus) or isinstance(s, models.LastWordsStatus):
            <textarea rows="4" cols="50" name="words"> </textarea>
        <p>
            <input type="submit" value="Submit"/> &nbsp; 
            <input type="reset" value="Reset"/>
        </p>
        </form>
    $else:
        <h1>等待其他人动作&nbsp;
        $if isinstance(s, models.TalkStatus) or isinstance(s, models.VoteStatus) or isinstance(s, models.LastWordsStatus):
            $','.join([p.nickname for p in s.actors if not s.completed[p]])
        </h1>
        <script type="text/JavaScript">
            setTimeout("location.reload(true);",15000);
        </script>
        
    
<a href="javascript:history.go(0)">刷新</a>
   
<script language="JavaScript">

    function autoResize(id){
        var newwidth;
    
        if(document.getElementById){
            newwidth=document.getElementById(id).contentWindow.document.body.scrollWidth;
        }
    
        document.getElementById(id).width= (newwidth) + "px";
    }

</script>